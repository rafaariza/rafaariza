---
layout: single
title: Forwardslash - Hack The Box
excerpt: "Forwardslash starts off like most classic Hack The Box machines with some enumeration of vhosts, files and directories with gobuster then we use a Server-Side Request Forgery (SSRF) vulnerability to reach a protected dev directory only accessible from localhost. After finding credentials and getting a shell, we'll analyze and exploit a small backup program to read files as user pain and find more credentials. In the spirit of Team Unintended, instead of solving the crypto challenge to get root I used the sudo commands available to me to upload and mount my own Luks container and execute a SUID bash binary."
date: 2020-07-04
classes: wide
header:
  teaser: /assets/images/htb-writeup-forwardslash/forwardslash_logo.png
  teaser_home_page: true
  icon: /assets/images/hackthebox.webp
categories:
  - hackthebox
  - infosec
tags:
  - php
  - vhosts
  - ssrf
  - ltrace
  - python
  - unintended
  - luks
---

![](/assets/images/htb-writeup-forwardslash/forwardslash_logo.png)

Forwardslash starts off like most classic Hack The Box machines with some enumeration of vhosts, files and directories with gobuster then we use a Server-Side Request Forgery (SSRF) vulnerability to reach a protected dev directory only accessible from localhost. After finding credentials and getting a shell, we'll analyze and exploit a small backup program to read files as user pain and find more credentials. In the spirit of Team Unintended, instead of solving the crypto challenge to get root I used the sudo commands available to me to upload and mount my own Luks container and execute a SUID bash binary.

## Summary

- Find the `backup` vhost, create an account and log in to the dashboard
- Enumerate the `backup` vhost with gobuster, find a `/dev` directory that only allows connections from localhost
- Use the disabled change profile picture page to do an SSRF and access the `/dev` directory, finding the `chiv` user password
- SSH in as user `chiv`, reverse a backup utitity and write a script to compute the expected MD5 hash, gaining arbitrary file read as user `pain`
- Find the password for user `pain` in `/var/backups/config.php.bak`
- Gain root the unintended way by using the sudo `luksOpen` and `mount` commands to mount a volume where a SUID `/bin/bash` binary has been placed

## Portscan

```
root@kali:~/htb/forwardslash# nmap -sC -sV -p- 10.10.10.183
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-05 07:42 EDT
Nmap scan report for forwardslash.htb (10.10.10.183)
Host is up (0.016s latency).
Not shown: 65533 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 3c:3b:eb:54:96:81:1d:da:d7:96:c7:0f:b4:7e:e1:cf (RSA)
|   256 f6:b3:5f:a2:59:e3:1e:57:35:36:c3:fe:5e:3d:1f:66 (ECDSA)
|_  256 1b:de:b8:07:35:e8:18:2c:19:d8:cc:dd:77:9c:f2:5e (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Backslash Gang
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```